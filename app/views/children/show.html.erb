<h1><%= @child.name %></h1>

<p>
  <strong>Date de naissance :</strong> <%= l(@child.birth_date, format: :long) %><br>
  <strong>Genre :</strong> <%= @child.gender %>
</p>

<div class="mt-4">
  <%= link_to "Modifier le profil", edit_child_path(@child), class: "btn btn-warning me-2" if @child_access&.parent? %>
  <%= link_to "Retour Ã  la liste", children_path, class: "btn btn-secondary" %>
</div>

<hr>

<h2>Ã‰vÃ©nements Ã  venir</h2>
<p class="text-muted">On ajoutera la liste des Ã©vÃ©nements ici plus tard ğŸ‘¶</p>

<hr>

<h3>Personnes ayant accÃ¨s Ã  ce profil</h3>

<% if @child.users.any? %>
  <ul class="list-group mb-4">
    <% @child.users.each do |user| %>
      <% access = @child.child_accesses.find_by(user: user) %>
      <li class="list-group-item d-flex justify-content-between align-items-center">
        <%= user.email %>
        <span class="badge bg-primary rounded-pill">
          <%= access.role.capitalize %>
        </span>
      </li>
    <% end %>
  </ul>
<% else %>
  <p class="text-muted">Personne d'autre n'a accÃ¨s pour l'instant.</p>
<% end %>

<% if @child_access&.parent? %>
  <h4>Inviter une personne</h4>

  <%= form_with url: child_invitations_path(@child), local: true do |f| %>
    <div class="row">
      <div class="col-md-5 mb-3">
        <%= f.label :email, "Email de la personne" %>
        <%= f.email_field :email, class: "form-control", required: true %>
      </div>

      <div class="col-md-4 mb-3">
        <%= f.label :role, "RÃ´le" %>
        <%= f.select :role,
                     options_for_select([
                       ["Parent", "parent"],
                       ["Famille", "family"],
                       ["Garde (nounou...)", "garde"],
                       ["MÃ©dical (pÃ©diatre...)", "mÃ©dical"],
                       ["Lecture seule", "viewer"]
                     ]),
                     {},
                     class: "form-control" %>
      </div>

      <div class="col-md-3 d-flex align-items-end">
        <%= f.submit "Envoyer l'invitation", class: "btn btn-success" %>
      </div>
    </div>
  <% end %>
<% end %>